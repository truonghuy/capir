<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>UnityCAPIR: /Users/truonghuy/Research/amdp/UnityCAPIR/UnityCAPIR/Assets/Scripts/MainCSharp.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="sheep-icon-normal.png"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">UnityCAPIR&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">API documentation of UnityCAPIR</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_main_c_sharp_8cs.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<h1>/Users/truonghuy/Research/amdp/UnityCAPIR/UnityCAPIR/Assets/Scripts/MainCSharp.cs</h1>  </div>
</div>
<div class="contents">
<a href="_main_c_sharp_8cs.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="keyword">using</span> UnityEngine;
<a name="l00002"></a>00002 <span class="keyword">using</span> System.Collections;
<a name="l00003"></a>00003 <span class="keyword">using</span> System.Collections.Generic;
<a name="l00004"></a>00004 
<a name="l00006"></a>00006 <span class="keyword">using</span> System.IO;
<a name="l00007"></a>00007 <span class="keyword">using</span> System.Text.RegularExpressions;
<a name="l00008"></a>00008 
<a name="l00012"></a><a class="code" href="class_main_c_sharp.html">00012</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_main_c_sharp.html" title="The main game script.">MainCSharp</a> : MonoBehaviour {
<a name="l00013"></a>00013  
<a name="l00017"></a><a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207">00017</a>  <span class="keyword">public</span> <a class="code" href="class_capir_box.html" title="The CAPIR object for action query.">CapirBox</a> <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a> {<span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>;}
<a name="l00018"></a>00018  
<a name="l00019"></a>00019  
<a name="l00020"></a>00020  <span class="comment">/************  Level data *******************************/</span>
<a name="l00026"></a><a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078">00026</a>  <span class="keyword">public</span> <a class="code" href="class_map_data.html" title="This class represents the level&amp;#39;s map and initial state.">MapData</a> <a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>;
<a name="l00027"></a>00027  
<a name="l00031"></a><a class="code" href="class_main_c_sharp.html#af810f5d3a2e6f0493b34ffe7a3502462">00031</a>  <span class="keyword">public</span> <a class="code" href="class_state.html" title="State class. Stores the game state.">State</a> <a class="code" href="class_main_c_sharp.html#af810f5d3a2e6f0493b34ffe7a3502462" title="Current state of the level.">state</a> {<span class="keyword">get</span>; <span class="keyword">set</span>;}
<a name="l00035"></a><a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d">00035</a>  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>;
<a name="l00039"></a><a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1">00039</a>  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a>;
<a name="l00043"></a><a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4">00043</a>  <span class="keyword">private</span> List&lt;bool&gt; <a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a>;
<a name="l00050"></a><a class="code" href="class_main_c_sharp.html#a030f78127e378824b9eeb02650b63a25">00050</a>  <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_main_c_sharp.html#a030f78127e378824b9eeb02650b63a25" title="Gets or sets a value indicating whether the current level has ended.">gameEnded</a> {<span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>;}
<a name="l00051"></a>00051  
<a name="l00052"></a>00052  <span class="comment">/*********** Prefab for Graphic ***************************/</span>
<a name="l00056"></a><a class="code" href="class_main_c_sharp.html#a5e3517ccc035e85997fc435ef61f8bea">00056</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a5e3517ccc035e85997fc435ef61f8bea" title="The GameObject to represent wall.">wallCube</a>;
<a name="l00060"></a><a class="code" href="class_main_c_sharp.html#a13bff88a1bd70746e81b004092c8f221">00060</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a13bff88a1bd70746e81b004092c8f221" title="The GameObject to represent floor.">floorCube</a>;
<a name="l00064"></a><a class="code" href="class_main_c_sharp.html#aaabcd7df9e88111731f6a9b5e377412a">00064</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#aaabcd7df9e88111731f6a9b5e377412a" title="The GameObject to represent human-controlled character.">agentCube</a>;
<a name="l00068"></a><a class="code" href="class_main_c_sharp.html#a7ccd40cb1491a52181da42c6767775cf">00068</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a7ccd40cb1491a52181da42c6767775cf" title="The GameObject to represent AI-controlled character.">helperCube</a>;
<a name="l00072"></a><a class="code" href="class_main_c_sharp.html#aee8eed909dd4750dd82428fdb2930979">00072</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#aee8eed909dd4750dd82428fdb2930979" title="The GameObject to represent Ghost.">ghostCube</a>;
<a name="l00076"></a><a class="code" href="class_main_c_sharp.html#a00ed790b650dbd0ebb65136899239363">00076</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a00ed790b650dbd0ebb65136899239363" title="The GameObject to represent Sheep.">sheepCube</a>;
<a name="l00080"></a><a class="code" href="class_main_c_sharp.html#a21cc98197e29e1abb759396a76b87e8c">00080</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a21cc98197e29e1abb759396a76b87e8c" title="The GameObject to represent Fiery.">fieryCube</a>;
<a name="l00084"></a><a class="code" href="class_main_c_sharp.html#ad91e06902ab84ba078ae093b130dbb5c">00084</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#ad91e06902ab84ba078ae093b130dbb5c" title="The GameObject to represent Sheep pen.">sheepPenCube</a>;
<a name="l00088"></a><a class="code" href="class_main_c_sharp.html#a7de984aeb8166719f0ecfc4b1482b932">00088</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a7de984aeb8166719f0ecfc4b1482b932" title="The GameObject to represent Fiery pen.">fieryPenCube</a>;
<a name="l00092"></a><a class="code" href="class_main_c_sharp.html#a2793d5a6216dd1869f17fecebf2b63b2">00092</a>  <span class="keyword">public</span> GameObject <a class="code" href="class_main_c_sharp.html#a2793d5a6216dd1869f17fecebf2b63b2" title="The GameObject to represent Fiery exit.">fieryExitCube</a>;
<a name="l00093"></a>00093  
<a name="l00097"></a><a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464">00097</a>  <span class="keyword">private</span> List&lt;GameObject&gt; <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>;
<a name="l00101"></a><a class="code" href="class_main_c_sharp.html#ac3119858daac19666864fb41033f278c">00101</a>  <span class="keyword">private</span> GameObject <a class="code" href="class_main_c_sharp.html#ac3119858daac19666864fb41033f278c" title="The human-controlled character.">agent</a>;
<a name="l00105"></a><a class="code" href="class_main_c_sharp.html#a3a62b61789eb150a17bc076990d336eb">00105</a>  <span class="keyword">private</span> GameObject <a class="code" href="class_main_c_sharp.html#a3a62b61789eb150a17bc076990d336eb" title="The AI-controlled character.">helper</a>;
<a name="l00106"></a>00106  
<a name="l00107"></a>00107  
<a name="l00108"></a>00108  <span class="comment">/************ properties for NPCs *************************/</span>
<a name="l00115"></a><a class="code" href="class_main_c_sharp.html#a02ba8220f4a4b6e1851f2722e10e27fd">00115</a>  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#a02ba8220f4a4b6e1851f2722e10e27fd" title="Gets or sets the ghost vision limit.">ghostVisLim</a> {<span class="keyword">get</span>;<span class="keyword">set</span>;}
<a name="l00122"></a><a class="code" href="class_main_c_sharp.html#a2ee0f3f47540ecd4b7ac9660b29a8dbd">00122</a>  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#a2ee0f3f47540ecd4b7ac9660b29a8dbd" title="Gets or sets the Sheep vision limit.">sheepVisLim</a> {<span class="keyword">get</span>;<span class="keyword">set</span>;}
<a name="l00129"></a><a class="code" href="class_main_c_sharp.html#ae107248dee54bf942316b382f164fff2">00129</a>  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#ae107248dee54bf942316b382f164fff2" title="Gets or sets the Fiery vision limit.">fieryVisLim</a> {<span class="keyword">get</span>;<span class="keyword">set</span>;}
<a name="l00130"></a>00130  
<a name="l00137"></a><a class="code" href="class_main_c_sharp.html#af428bbb428c8822bdb298608240c4149">00137</a>  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#af428bbb428c8822bdb298608240c4149" title="Gets or sets the ghost max HP.">ghostMaxHP</a> {<span class="keyword">get</span>; <span class="keyword">set</span>;}
<a name="l00145"></a><a class="code" href="class_main_c_sharp.html#afa6d3b6bc1f48bd8babeb9c6b451ec3d">00145</a>  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_main_c_sharp.html#afa6d3b6bc1f48bd8babeb9c6b451ec3d" title="Gets or sets the ghost shot distance, within which the human-controlled character can shoot the ghost...">ghostShotDistance</a> {<span class="keyword">get</span>; <span class="keyword">set</span>;}
<a name="l00146"></a>00146  
<a name="l00147"></a>00147  <span class="comment">/******************** Functions ***************************/</span>
<a name="l00148"></a>00148  
<a name="l00149"></a>00149  
<a name="l00158"></a><a class="code" href="class_main_c_sharp.html#a63d2c877a056534fb3dea98c1e0e271b">00158</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a63d2c877a056534fb3dea98c1e0e271b" title="Wakens this instance.">Awake</a>()
<a name="l00159"></a>00159  {
<a name="l00160"></a>00160   <span class="comment">// widescreen orientation</span>
<a name="l00161"></a>00161   Screen.orientation = ScreenOrientation.Portrait;
<a name="l00162"></a>00162   
<a name="l00163"></a>00163   <span class="comment">//levelString = levelFile.text;</span>
<a name="l00164"></a>00164   GameObject go = GameObject.FindGameObjectWithTag(<span class="stringliteral">&quot;LevelChoice&quot;</span>);
<a name="l00165"></a>00165   <a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a> = <span class="keywordtype">int</span>.Parse(go.GetComponent&lt;<a class="code" href="class_level_info_script.html" title="The class stores the chosen level.">LevelInfoScript</a>&gt;().<a class="code" href="class_level_info_script.html#a50c7a2c4fb034b01351d7e2036162720" title="The chosen level.">chosenLevel</a>) - 1;
<a name="l00166"></a>00166   <span class="comment">//levelString = &quot;level&quot; + go.GetComponent&lt;LevelInfoScript&gt;().chosenLevel + &quot;.tmx&quot;;</span>
<a name="l00167"></a>00167   
<a name="l00168"></a>00168   
<a name="l00169"></a>00169   <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a> = <span class="keyword">new</span> <a class="code" href="class_capir_box.html" title="The CAPIR object for action query.">CapirBox</a>(<span class="keyword">this</span>);
<a name="l00170"></a>00170   
<a name="l00171"></a>00171   
<a name="l00172"></a>00172   <a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a> = 4;
<a name="l00173"></a>00173   <a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a> = <span class="keyword">new</span> List&lt;bool&gt;();
<a name="l00174"></a>00174   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a>; i++)
<a name="l00175"></a>00175    <a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a>.Add(<span class="keyword">false</span>);
<a name="l00176"></a>00176   
<a name="l00177"></a>00177   <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a> = <span class="keyword">new</span> List&lt;GameObject&gt;();
<a name="l00178"></a>00178   <a class="code" href="class_main_c_sharp.html#af810f5d3a2e6f0493b34ffe7a3502462" title="Current state of the level.">state</a> = <span class="keyword">new</span> <a class="code" href="class_state.html" title="State class. Stores the game state.">State</a>();
<a name="l00179"></a>00179   
<a name="l00180"></a>00180   <span class="comment">// agent and helper always exist</span>
<a name="l00181"></a>00181   <a class="code" href="class_main_c_sharp.html#ac3119858daac19666864fb41033f278c" title="The human-controlled character.">agent</a> = Instantiate(<a class="code" href="class_main_c_sharp.html#aaabcd7df9e88111731f6a9b5e377412a" title="The GameObject to represent human-controlled character.">agentCube</a>, <span class="keyword">new</span> Vector3 (0,0, 0), Quaternion.identity) as GameObject;
<a name="l00182"></a>00182      <a class="code" href="class_main_c_sharp.html#a3a62b61789eb150a17bc076990d336eb" title="The AI-controlled character.">helper</a> = Instantiate(<a class="code" href="class_main_c_sharp.html#a7ccd40cb1491a52181da42c6767775cf" title="The GameObject to represent AI-controlled character.">helperCube</a>, <span class="keyword">new</span> Vector3 (0,0, 0), Quaternion.identity) as GameObject;
<a name="l00183"></a>00183    
<a name="l00184"></a>00184   
<a name="l00185"></a>00185   <a class="code" href="class_main_c_sharp.html#af77fa9c12a8e6a7af4d3cc60bd5dd456" title="Sets up the given level, i.e., calling loadLevel to read from .TMX file and invoking createObjects on...">setUpLevel</a>(<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>);
<a name="l00186"></a>00186   
<a name="l00187"></a>00187   <a class="code" href="class_main_c_sharp.html#a5950269a5a22c0723fa8b86e897206fd" title="Starts the level.">startLevel</a>();
<a name="l00188"></a>00188  }
<a name="l00189"></a>00189  
<a name="l00193"></a><a class="code" href="class_main_c_sharp.html#a7c39f4f8e72d96f811f7e7a6b4664b06">00193</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a7c39f4f8e72d96f811f7e7a6b4664b06" title="Starts this instance. Invoke initialization routine of capirBox .">Start</a> () {
<a name="l00194"></a>00194   <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a>.<a class="code" href="class_capir_box.html#abc2f8e9735f6cfcdc067d463ca0bb729" title="Start this instance.">Start</a>();
<a name="l00195"></a>00195  }
<a name="l00196"></a>00196  
<a name="l00200"></a><a class="code" href="class_main_c_sharp.html#a7ffb728702db283ee5fb89c05aec0e58">00200</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a7ffb728702db283ee5fb89c05aec0e58" title="Updates this instance: updates capirBox  and checks if the game is finished.">Update</a>()
<a name="l00201"></a>00201  {
<a name="l00202"></a>00202   <a class="code" href="class_main_c_sharp.html#a87c7ba19730bbcf9776d6d0b9bcc913a" title="Updates the transparency of the characters if they are standing on top of any goal position (pen and ...">UpdateTransparency</a>();
<a name="l00203"></a>00203   
<a name="l00204"></a>00204   <span class="comment">// 0. Check if the game is finished</span>
<a name="l00205"></a>00205   <span class="keywordflow">if</span> (<a class="code" href="class_main_c_sharp.html#a0396f185639b202c8362ed5c3f6cfd81" title="Checks if the game is over.">gameFinished</a>()){
<a name="l00206"></a>00206    <a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a>[<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>] = <span class="keyword">true</span>;
<a name="l00207"></a>00207    <a class="code" href="class_main_c_sharp.html#a030f78127e378824b9eeb02650b63a25" title="Gets or sets a value indicating whether the current level has ended.">gameEnded</a> = <span class="keyword">true</span>;
<a name="l00208"></a>00208    <span class="keywordflow">return</span>;
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210   
<a name="l00211"></a>00211   <span class="comment">// update capirBox to update belief, action...</span>
<a name="l00212"></a>00212   <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a>.<a class="code" href="class_capir_box.html#a45ff7805f9ebf9b934c2d1ddee107586" title="Does nothing.">Update</a>();
<a name="l00213"></a>00213  }
<a name="l00214"></a>00214  
<a name="l00221"></a><a class="code" href="class_main_c_sharp.html#a0396f185639b202c8362ed5c3f6cfd81">00221</a>  <span class="keywordtype">bool</span> <a class="code" href="class_main_c_sharp.html#a0396f185639b202c8362ed5c3f6cfd81" title="Checks if the game is over.">gameFinished</a>(){
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <span class="keywordflow">foreach</span> (GameObject npc <span class="keywordflow">in</span> <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>){
<a name="l00224"></a>00224    <span class="keywordflow">if</span> (!(npc.GetComponent&lt;<a class="code" href="class_n_p_c_behavior.html" title="The base class of NPC behavior.">NPCBehavior</a>&gt;().<a class="code" href="class_n_p_c_behavior.html#a53b71546331f161f06f892b67c9df80c" title="Gets or sets a value indicating whether this NPCBehavior is solved.">isSolved</a>))
<a name="l00225"></a>00225     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00226"></a>00226   }
<a name="l00227"></a>00227   
<a name="l00228"></a>00228   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00229"></a>00229  }
<a name="l00230"></a>00230  
<a name="l00240"></a><a class="code" href="class_main_c_sharp.html#a972d74400e20f67b7a47155eb726b81c">00240</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a972d74400e20f67b7a47155eb726b81c" title="Loads the level level .">loadLevel</a>(<span class="keywordtype">int</span> level){
<a name="l00241"></a>00241   
<a name="l00242"></a>00242   <span class="comment">// Read the map file and load policy files</span>
<a name="l00243"></a>00243   <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a>.<a class="code" href="class_capir_box.html#a0bed09e886ab0581c98e5e68c1473695" title="Reads the tmx file. Use this for initialization.">readTmxFile</a>(<span class="stringliteral">&quot;level&quot;</span> + (level+1).ToString() + <span class="stringliteral">&quot;.tmx&quot;</span>);
<a name="l00244"></a>00244  }
<a name="l00245"></a>00245  
<a name="l00253"></a><a class="code" href="class_main_c_sharp.html#af77fa9c12a8e6a7af4d3cc60bd5dd456">00253</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#af77fa9c12a8e6a7af4d3cc60bd5dd456" title="Sets up the given level, i.e., calling loadLevel to read from .TMX file and invoking createObjects on...">setUpLevel</a>(<span class="keywordtype">int</span> level){
<a name="l00254"></a>00254   <a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a> = level;
<a name="l00255"></a>00255   <a class="code" href="class_main_c_sharp.html#a972d74400e20f67b7a47155eb726b81c" title="Loads the level level .">loadLevel</a>(<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>);
<a name="l00256"></a>00256   <a class="code" href="class_main_c_sharp.html#a76dca438c76436d65d71bf3054a2c892" title="Creates the game objects for the whole level, as described by levelData .">createObjects</a>(<a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#aeec30c5399a9d0e07410801988c7b1e7" title="The initial state.">initConfig</a>);
<a name="l00257"></a>00257  }
<a name="l00258"></a>00258  
<a name="l00268"></a><a class="code" href="class_main_c_sharp.html#a57c071806084f2bd6388e839ae15a884">00268</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a57c071806084f2bd6388e839ae15a884" title="Copies the state from src  to dest .">copyState</a>(<a class="code" href="class_state.html" title="State class. Stores the game state.">State</a> src, <a class="code" href="class_state.html" title="State class. Stores the game state.">State</a> dest){
<a name="l00269"></a>00269   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt; 2; i++)
<a name="l00270"></a>00270    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt; 2; j++)
<a name="l00271"></a>00271     dest.<a class="code" href="class_state.html#a23a4eb779b23b02a6e0e4c5829965dc8" title="Two players, each having only (x,y) coordinates. 0: human, 1: helper.">playerProperties</a>[i,j] = src.<a class="code" href="class_state.html#a23a4eb779b23b02a6e0e4c5829965dc8" title="Two players, each having only (x,y) coordinates. 0: human, 1: helper.">playerProperties</a>[i,j];
<a name="l00272"></a>00272   
<a name="l00273"></a>00273   dest.<a class="code" href="class_state.html#ad463ed23c1243917cacda51e58fe02fb" title="List of NPC properties. At least 3 properties for mazeProperties[i]: type, coordX, coordY.">mazeProperties</a>.Clear();
<a name="l00274"></a>00274   <span class="keywordflow">foreach</span>(List&lt;int&gt; mazeProp <span class="keywordflow">in</span> src.mazeProperties){
<a name="l00275"></a>00275    List&lt;int&gt; tempProb = <span class="keyword">new</span> List&lt;int&gt;();
<a name="l00276"></a>00276    <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> prop <span class="keywordflow">in</span> mazeProp){
<a name="l00277"></a>00277     tempProb.Add(prop);
<a name="l00278"></a>00278    }
<a name="l00279"></a>00279    dest.mazeProperties.Add(tempProb);
<a name="l00280"></a>00280   }
<a name="l00281"></a>00281  }
<a name="l00282"></a>00282  
<a name="l00289"></a><a class="code" href="class_main_c_sharp.html#a0a84052811b18630763fd798707f9e00">00289</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a0a84052811b18630763fd798707f9e00" title="Clears the level.">clearLevel</a>(){
<a name="l00290"></a>00290   
<a name="l00291"></a>00291   GameObject[] gos;
<a name="l00292"></a>00292   gos =  GameObject.FindGameObjectsWithTag(<span class="stringliteral">&quot;MapElement&quot;</span>); 
<a name="l00293"></a>00293   <span class="keywordflow">foreach</span>(GameObject go <span class="keywordflow">in</span> gos){
<a name="l00294"></a>00294    Destroy(go);
<a name="l00295"></a>00295   }
<a name="l00296"></a>00296   
<a name="l00297"></a>00297   <span class="keywordflow">foreach</span> (GameObject go <span class="keywordflow">in</span> <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>){
<a name="l00298"></a>00298    Destroy(go);
<a name="l00299"></a>00299   }
<a name="l00300"></a>00300   monsters.Clear();
<a name="l00301"></a>00301   <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a>.<a class="code" href="class_capir_box.html#a089747b59ec4a16181150301ecf24ddf" title="Clear this instance: clear npcTypes, QValues and existingNPCTypes.">clear</a>();
<a name="l00302"></a>00302  }
<a name="l00303"></a>00303  
<a name="l00304"></a>00304  
<a name="l00309"></a><a class="code" href="class_main_c_sharp.html#a87c7ba19730bbcf9776d6d0b9bcc913a">00309</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a87c7ba19730bbcf9776d6d0b9bcc913a" title="Updates the transparency of the characters if they are standing on top of any goal position (pen and ...">UpdateTransparency</a> (){
<a name="l00310"></a>00310   <span class="comment">// the players</span>
<a name="l00311"></a>00311   <a class="code" href="class_main_c_sharp.html#a5eb254a11296ea07a6e73dd0fcbf9cbb" title="Updates the transparency of GameObject go .">UpdateTransparencyGO</a>(<a class="code" href="class_main_c_sharp.html#ac3119858daac19666864fb41033f278c" title="The human-controlled character.">agent</a>);
<a name="l00312"></a>00312   <a class="code" href="class_main_c_sharp.html#a5eb254a11296ea07a6e73dd0fcbf9cbb" title="Updates the transparency of GameObject go .">UpdateTransparencyGO</a>(<a class="code" href="class_main_c_sharp.html#a3a62b61789eb150a17bc076990d336eb" title="The AI-controlled character.">helper</a>);
<a name="l00313"></a>00313   
<a name="l00314"></a>00314   <span class="comment">// monsters</span>
<a name="l00315"></a>00315   <span class="keywordflow">foreach</span>(GameObject npc <span class="keywordflow">in</span> <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>){
<a name="l00316"></a>00316    <a class="code" href="class_main_c_sharp.html#a5eb254a11296ea07a6e73dd0fcbf9cbb" title="Updates the transparency of GameObject go .">UpdateTransparencyGO</a>(npc);
<a name="l00317"></a>00317   }
<a name="l00318"></a>00318  }
<a name="l00319"></a>00319  
<a name="l00330"></a><a class="code" href="class_main_c_sharp.html#a5eb254a11296ea07a6e73dd0fcbf9cbb">00330</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a5eb254a11296ea07a6e73dd0fcbf9cbb" title="Updates the transparency of GameObject go .">UpdateTransparencyGO</a>(GameObject go){
<a name="l00331"></a>00331   <span class="keywordtype">int</span> tempX, tempY;
<a name="l00332"></a>00332   tempX = Mathf.RoundToInt(go.transform.position.x);
<a name="l00333"></a>00333   tempY = Mathf.RoundToInt(go.transform.position.z);
<a name="l00334"></a>00334   
<a name="l00335"></a>00335   Color colr = go.renderer.material.color;
<a name="l00336"></a>00336   <span class="comment">// if the go&#39;s position matches a goal</span>
<a name="l00337"></a>00337   <span class="keywordflow">if</span> (<a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#a4b208d1f9c0aa26723036d75058035be" title="The map layout.">map</a>[tempX, tempY] == <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a9d322a4981c13708bd22c5e4e7471a82">SheepPen</a> ||
<a name="l00338"></a>00338    <a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#a4b208d1f9c0aa26723036d75058035be" title="The map layout.">map</a>[tempX, tempY] == <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#aad007b44a4bcd7246d3c35822b3e2a1e">FieryPen</a> ||
<a name="l00339"></a>00339    <a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#a4b208d1f9c0aa26723036d75058035be" title="The map layout.">map</a>[tempX, tempY] == <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a6903974cd2c6a54a724034848c799ef8">FieryExit</a>
<a name="l00340"></a>00340    )
<a name="l00341"></a>00341   {
<a name="l00342"></a>00342    <span class="comment">// set alpha to 0.7</span>
<a name="l00343"></a>00343    <span class="keywordflow">if</span> (colr.a != 0.7f){
<a name="l00344"></a>00344     colr.a = 0.7f;
<a name="l00345"></a>00345     go.renderer.material.color = colr;
<a name="l00346"></a>00346    }
<a name="l00347"></a>00347   }
<a name="l00348"></a>00348   <span class="keywordflow">else</span>{
<a name="l00349"></a>00349    <span class="keywordflow">if</span> (colr.a != 1.0f){
<a name="l00350"></a>00350     colr.a = 1.0f;
<a name="l00351"></a>00351     go.renderer.material.color = colr;
<a name="l00352"></a>00352    }
<a name="l00353"></a>00353   }
<a name="l00354"></a>00354  }
<a name="l00355"></a>00355 
<a name="l00359"></a><a class="code" href="class_main_c_sharp.html#a5950269a5a22c0723fa8b86e897206fd">00359</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a5950269a5a22c0723fa8b86e897206fd" title="Starts the level.">startLevel</a>(){
<a name="l00360"></a>00360   
<a name="l00361"></a>00361   <a class="code" href="class_main_c_sharp.html#a5b43ee5f169af445f75019f806ee5207" title="The AI CAPIR object.">capirBox</a>.<a class="code" href="class_capir_box.html#a34b878b7e4f16a188cf42109c109c573" title="Restart this instance: initialize belief to uniform distribution.">restart</a>();
<a name="l00362"></a>00362   
<a name="l00363"></a>00363   <span class="comment">// 2. copy state from init state levels to state</span>
<a name="l00364"></a>00364   <a class="code" href="class_main_c_sharp.html#a57c071806084f2bd6388e839ae15a884" title="Copies the state from src  to dest .">copyState</a>(<a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#aeec30c5399a9d0e07410801988c7b1e7" title="The initial state.">initConfig</a>, <a class="code" href="class_main_c_sharp.html#af810f5d3a2e6f0493b34ffe7a3502462" title="Current state of the level.">state</a>);
<a name="l00365"></a>00365   
<a name="l00366"></a>00366   <span class="comment">// 3. draw state</span>
<a name="l00367"></a>00367   <a class="code" href="class_main_c_sharp.html#aeae214f651a4184ee9449ecfdaa68de6" title="Moves the positions of characters to the position as described by state s .">drawState</a>(<a class="code" href="class_main_c_sharp.html#af810f5d3a2e6f0493b34ffe7a3502462" title="Current state of the level.">state</a>);
<a name="l00368"></a>00368   
<a name="l00369"></a>00369   <a class="code" href="class_main_c_sharp.html#a3a62b61789eb150a17bc076990d336eb" title="The AI-controlled character.">helper</a>.GetComponent&lt;<a class="code" href="class_helper_script.html" title="This class defines the behavior of the helper.">HelperScript</a>&gt;().Restart();
<a name="l00370"></a>00370   <a class="code" href="class_main_c_sharp.html#ac3119858daac19666864fb41033f278c" title="The human-controlled character.">agent</a>.GetComponent&lt;<a class="code" href="class_agent_script.html" title="Control script of the human-controlled character.">AgentScript</a>&gt;().Restart();
<a name="l00371"></a>00371   
<a name="l00372"></a>00372   <span class="keywordflow">foreach</span>(GameObject npc <span class="keywordflow">in</span> <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>){
<a name="l00373"></a>00373    npc.GetComponent&lt;<a class="code" href="class_n_p_c_behavior.html" title="The base class of NPC behavior.">NPCBehavior</a>&gt;().Restart();
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375   
<a name="l00376"></a>00376   <a class="code" href="class_main_c_sharp.html#a030f78127e378824b9eeb02650b63a25" title="Gets or sets a value indicating whether the current level has ended.">gameEnded</a> = <span class="keyword">false</span>;
<a name="l00377"></a>00377  }
<a name="l00378"></a>00378  
<a name="l00385"></a><a class="code" href="class_main_c_sharp.html#aeae214f651a4184ee9449ecfdaa68de6">00385</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#aeae214f651a4184ee9449ecfdaa68de6" title="Moves the positions of characters to the position as described by state s .">drawState</a>(<a class="code" href="class_state.html" title="State class. Stores the game state.">State</a> s){
<a name="l00386"></a>00386   <a class="code" href="class_main_c_sharp.html#ac3119858daac19666864fb41033f278c" title="The human-controlled character.">agent</a>.transform.position = <span class="keyword">new</span> Vector3(s.<a class="code" href="class_state.html#a23a4eb779b23b02a6e0e4c5829965dc8" title="Two players, each having only (x,y) coordinates. 0: human, 1: helper.">playerProperties</a>[0,0], 0, 
<a name="l00387"></a>00387    s.<a class="code" href="class_state.html#a23a4eb779b23b02a6e0e4c5829965dc8" title="Two players, each having only (x,y) coordinates. 0: human, 1: helper.">playerProperties</a>[0,1]);
<a name="l00388"></a>00388   <a class="code" href="class_main_c_sharp.html#a3a62b61789eb150a17bc076990d336eb" title="The AI-controlled character.">helper</a>.transform.position = <span class="keyword">new</span> Vector3(s.<a class="code" href="class_state.html#a23a4eb779b23b02a6e0e4c5829965dc8" title="Two players, each having only (x,y) coordinates. 0: human, 1: helper.">playerProperties</a>[1,0], 0, 
<a name="l00389"></a>00389    s.<a class="code" href="class_state.html#a23a4eb779b23b02a6e0e4c5829965dc8" title="Two players, each having only (x,y) coordinates. 0: human, 1: helper.">playerProperties</a>[1,1]);
<a name="l00390"></a>00390      <span class="comment">// monster</span>
<a name="l00391"></a>00391   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; s.<a class="code" href="class_state.html#ad463ed23c1243917cacda51e58fe02fb" title="List of NPC properties. At least 3 properties for mazeProperties[i]: type, coordX, coordY.">mazeProperties</a>.Count; i++){
<a name="l00392"></a>00392    <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>[i].transform.position = <span class="keyword">new</span> Vector3(s.<a class="code" href="class_state.html#ad463ed23c1243917cacda51e58fe02fb" title="List of NPC properties. At least 3 properties for mazeProperties[i]: type, coordX, coordY.">mazeProperties</a>[i][1], 0, 
<a name="l00393"></a>00393     s.<a class="code" href="class_state.html#ad463ed23c1243917cacda51e58fe02fb" title="List of NPC properties. At least 3 properties for mazeProperties[i]: type, coordX, coordY.">mazeProperties</a>[i][2]);
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395  }
<a name="l00396"></a>00396  
<a name="l00403"></a><a class="code" href="class_main_c_sharp.html#a76dca438c76436d65d71bf3054a2c892">00403</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a76dca438c76436d65d71bf3054a2c892" title="Creates the game objects for the whole level, as described by levelData .">createObjects</a>(<a class="code" href="class_state.html" title="State class. Stores the game state.">State</a> s) {
<a name="l00404"></a>00404   
<a name="l00405"></a>00405   <span class="keywordtype">int</span>[] sheepPenPos = <span class="keyword">new</span> <span class="keywordtype">int</span>[2];
<a name="l00406"></a>00406   <span class="keywordtype">int</span>[] fieryPenPos = <span class="keyword">new</span> <span class="keywordtype">int</span>[2];
<a name="l00407"></a>00407   <span class="keywordtype">int</span>[] fieryExitPos = <span class="keyword">new</span> <span class="keywordtype">int</span>[2];
<a name="l00408"></a>00408   
<a name="l00409"></a>00409   <span class="comment">// 1. Create MapElements for the map first</span>
<a name="l00410"></a>00410   <span class="keywordtype">int</span> floorDepth = -1;
<a name="l00411"></a>00411   <span class="keywordtype">float</span> penDepth = -0.5f;
<a name="l00412"></a>00412   
<a name="l00413"></a>00413   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#a40dbdb86b9c460c7632dbac951cf2a32" title="The map width.">xSize</a>; i++) {
<a name="l00414"></a>00414          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#a44cad0d7dcfde1abd20f923c0f1661ba" title="The map height.">ySize</a>; j++) {
<a name="l00415"></a>00415     Instantiate(<a class="code" href="class_main_c_sharp.html#a13bff88a1bd70746e81b004092c8f221" title="The GameObject to represent floor.">floorCube</a>, <span class="keyword">new</span> Vector3 (i, floorDepth, j), Quaternion.identity);
<a name="l00416"></a>00416     <span class="keywordflow">switch</span> (<a class="code" href="class_main_c_sharp.html#a779162d6b579af7e998a7d92775a7078" title="The level layout, storing the map configuration and the starting positions of characters. See MapData for further information.">levelData</a>.<a class="code" href="class_map_data.html#a4b208d1f9c0aa26723036d75058035be" title="The map layout.">map</a>[i,j]) {
<a name="l00417"></a>00417      <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a4a6e415e1dedf46c975c51527f6c76ba">Wall</a>:
<a name="l00418"></a>00418       Instantiate(<a class="code" href="class_main_c_sharp.html#a5e3517ccc035e85997fc435ef61f8bea" title="The GameObject to represent wall.">wallCube</a>, <span class="keyword">new</span> Vector3 (i, 0, j), Quaternion.identity);
<a name="l00419"></a>00419       <span class="keywordflow">break</span>;
<a name="l00420"></a>00420      <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a9d322a4981c13708bd22c5e4e7471a82">SheepPen</a>:
<a name="l00421"></a>00421       Instantiate(<a class="code" href="class_main_c_sharp.html#ad91e06902ab84ba078ae093b130dbb5c" title="The GameObject to represent Sheep pen.">sheepPenCube</a>, <span class="keyword">new</span> Vector3 (i, penDepth, j), Quaternion.identity);
<a name="l00422"></a>00422       sheepPenPos[0] = i;
<a name="l00423"></a>00423       sheepPenPos[1] = j;
<a name="l00424"></a>00424       <span class="keywordflow">break</span>;
<a name="l00425"></a>00425      <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#aad007b44a4bcd7246d3c35822b3e2a1e">FieryPen</a>:
<a name="l00426"></a>00426       Instantiate(<a class="code" href="class_main_c_sharp.html#a7de984aeb8166719f0ecfc4b1482b932" title="The GameObject to represent Fiery pen.">fieryPenCube</a>, <span class="keyword">new</span> Vector3 (i, penDepth, j), Quaternion.identity);
<a name="l00427"></a>00427       fieryPenPos[0] = i;
<a name="l00428"></a>00428       fieryPenPos[1] = j;
<a name="l00429"></a>00429       <span class="keywordflow">break</span>;
<a name="l00430"></a>00430      <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a6903974cd2c6a54a724034848c799ef8">FieryExit</a>:
<a name="l00431"></a>00431       Instantiate(<a class="code" href="class_main_c_sharp.html#a2793d5a6216dd1869f17fecebf2b63b2" title="The GameObject to represent Fiery exit.">fieryExitCube</a>, <span class="keyword">new</span> Vector3 (i, penDepth, j), Quaternion.identity);
<a name="l00432"></a>00432       fieryExitPos[0] = i;
<a name="l00433"></a>00433       fieryExitPos[1] = j;
<a name="l00434"></a>00434       <span class="keywordflow">break</span>;
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436          }
<a name="l00437"></a>00437      }
<a name="l00438"></a>00438      
<a name="l00439"></a>00439      <span class="comment">// 3. Monsters</span>
<a name="l00440"></a>00440   <span class="keywordtype">int</span> monsterIndex = 0;
<a name="l00441"></a>00441   <span class="keywordflow">foreach</span>(List&lt;int&gt; npcProb <span class="keywordflow">in</span> s.mazeProperties){
<a name="l00442"></a>00442    GameObject npc;
<a name="l00443"></a>00443    
<a name="l00444"></a>00444    <span class="keywordflow">switch</span>(npcProb[0]){
<a name="l00445"></a>00445    <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a8f005189ec74840e59de18ffb99fa2ac">SheepType</a>:
<a name="l00446"></a>00446     npc = Instantiate(<a class="code" href="class_main_c_sharp.html#a00ed790b650dbd0ebb65136899239363" title="The GameObject to represent Sheep.">sheepCube</a>, <span class="keyword">new</span> Vector3 (npcProb[1], 0, 
<a name="l00447"></a>00447      npcProb[2]), Quaternion.identity) as GameObject;
<a name="l00448"></a>00448     npc.GetComponent&lt;<a class="code" href="class_sheep_script.html" title="Behavior script of Sheep.">SheepScript</a>&gt;().xPen = sheepPenPos[0];
<a name="l00449"></a>00449     npc.GetComponent&lt;<a class="code" href="class_sheep_script.html" title="Behavior script of Sheep.">SheepScript</a>&gt;().yPen = sheepPenPos[1];
<a name="l00450"></a>00450     
<a name="l00451"></a>00451     <span class="keywordflow">break</span>;
<a name="l00452"></a>00452    <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a9adae103b4e7ce4675e033f07efdff5d">GhostType</a>:
<a name="l00453"></a>00453     npc = Instantiate(<a class="code" href="class_main_c_sharp.html#aee8eed909dd4750dd82428fdb2930979" title="The GameObject to represent Ghost.">ghostCube</a>, <span class="keyword">new</span> Vector3 (npcProb[1], 0, 
<a name="l00454"></a>00454      npcProb[2]), Quaternion.identity) as GameObject;
<a name="l00455"></a>00455     <span class="keywordflow">break</span>;
<a name="l00456"></a>00456    <span class="keywordflow">case</span> <a class="code" href="class_game_constants.html" title="This class defines the constants used in SheepSavior game.">GameConstants</a>.<a class="code" href="class_game_constants.html#a5f650facea7d8eb6cb1a62286d19ebf0">FieryType</a>:
<a name="l00457"></a>00457     npc = Instantiate(<a class="code" href="class_main_c_sharp.html#a21cc98197e29e1abb759396a76b87e8c" title="The GameObject to represent Fiery.">fieryCube</a>, <span class="keyword">new</span> Vector3 (npcProb[1], 0, 
<a name="l00458"></a>00458      npcProb[2]), Quaternion.identity) as GameObject;
<a name="l00459"></a>00459     npc.GetComponent&lt;<a class="code" href="class_fiery_script.html" title="Behavior script of Fiery.">FieryScript</a>&gt;().xPen = fieryPenPos[0];
<a name="l00460"></a>00460     npc.GetComponent&lt;<a class="code" href="class_fiery_script.html" title="Behavior script of Fiery.">FieryScript</a>&gt;().yPen = fieryPenPos[1];
<a name="l00461"></a>00461     npc.GetComponent&lt;<a class="code" href="class_fiery_script.html" title="Behavior script of Fiery.">FieryScript</a>&gt;().xExit = fieryExitPos[0];
<a name="l00462"></a>00462     npc.GetComponent&lt;<a class="code" href="class_fiery_script.html" title="Behavior script of Fiery.">FieryScript</a>&gt;().yExit = fieryExitPos[1];
<a name="l00463"></a>00463     <span class="keywordflow">break</span>;
<a name="l00464"></a>00464    <span class="keywordflow">default</span>:
<a name="l00465"></a>00465     npc = <span class="keyword">new</span> GameObject();
<a name="l00466"></a>00466     <span class="keywordflow">break</span>;
<a name="l00467"></a>00467    }
<a name="l00468"></a>00468    
<a name="l00469"></a>00469    npc.name = monsterIndex.ToString();
<a name="l00470"></a>00470    monsterIndex++;
<a name="l00471"></a>00471    <a class="code" href="class_main_c_sharp.html#a7478beb679ba17d502c4e85ef5498464" title="The list of NPCs.">monsters</a>.Add(npc);
<a name="l00472"></a>00472   }
<a name="l00473"></a>00473   
<a name="l00474"></a>00474   
<a name="l00475"></a>00475  }
<a name="l00476"></a>00476  
<a name="l00480"></a><a class="code" href="class_main_c_sharp.html#a7da65715d19ff2c5c67c2fca8ff93e6c">00480</a>  <span class="keywordtype">void</span> <a class="code" href="class_main_c_sharp.html#a7da65715d19ff2c5c67c2fca8ff93e6c" title="Updates the Menu in the game.">OnGUI</a> () {
<a name="l00481"></a>00481   <span class="keywordtype">string</span> caption, temp;
<a name="l00482"></a>00482   
<a name="l00483"></a>00483   <span class="keywordflow">if</span> (<a class="code" href="class_main_c_sharp.html#a030f78127e378824b9eeb02650b63a25" title="Gets or sets a value indicating whether the current level has ended.">gameEnded</a>)
<a name="l00484"></a>00484    caption = <span class="stringliteral">&quot;You won!\nRestart!&quot;</span>;
<a name="l00485"></a>00485   <span class="keywordflow">else</span> caption = <span class="stringliteral">&quot;Give up.\nRestart!&quot;</span>;
<a name="l00486"></a>00486   
<a name="l00487"></a>00487   <span class="comment">// 3 buttons</span>
<a name="l00488"></a>00488   <span class="comment">// Prev level, current level (restart), and next level</span>
<a name="l00489"></a>00489   <span class="keywordflow">if</span> (<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a> &gt;=1){
<a name="l00490"></a>00490    temp = (<a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a>[<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>-1])? <span class="stringliteral">&quot;(solved)\n&quot;</span> : <span class="stringliteral">&quot;(unsolved)\n&quot;</span>;
<a name="l00491"></a>00491    <span class="keywordflow">if</span> (GUI.Button (<span class="keyword">new</span> Rect (10, 10, (Screen.width-40)/3, 50), temp+<span class="stringliteral">&quot;Prev level&quot;</span>))
<a name="l00492"></a>00492       {
<a name="l00493"></a>00493     <a class="code" href="class_main_c_sharp.html#a0a84052811b18630763fd798707f9e00" title="Clears the level.">clearLevel</a>();
<a name="l00494"></a>00494     <a class="code" href="class_main_c_sharp.html#af77fa9c12a8e6a7af4d3cc60bd5dd456" title="Sets up the given level, i.e., calling loadLevel to read from .TMX file and invoking createObjects on...">setUpLevel</a>((<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>-1)%<a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a>);
<a name="l00495"></a>00495     <a class="code" href="class_main_c_sharp.html#a5950269a5a22c0723fa8b86e897206fd" title="Starts the level.">startLevel</a>();
<a name="l00496"></a>00496    }
<a name="l00497"></a>00497   }
<a name="l00498"></a>00498   
<a name="l00499"></a>00499   temp = (<a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a>[<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>])? <span class="stringliteral">&quot;(solved)\n&quot;</span> : <span class="stringliteral">&quot;(unsolved)\n&quot;</span>;
<a name="l00500"></a>00500   <span class="keywordflow">if</span> (GUI.Button (<span class="keyword">new</span> Rect (20+(Screen.width-40)/3, 10,(Screen.width-40)/3,50), temp+caption)) 
<a name="l00501"></a>00501    <a class="code" href="class_main_c_sharp.html#a5950269a5a22c0723fa8b86e897206fd" title="Starts the level.">startLevel</a>();
<a name="l00502"></a>00502    
<a name="l00503"></a>00503   <span class="keywordflow">if</span> (<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a> &lt;= <a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a> - 2){
<a name="l00504"></a>00504    temp = (<a class="code" href="class_main_c_sharp.html#ad297684d90cf453155116046a4af56b4" title="The status of levels (solved or not).">solvedLevel</a>[(<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>+1)%<a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a>])? <span class="stringliteral">&quot;(solved)\n&quot;</span> : <span class="stringliteral">&quot;(unsolved)\n&quot;</span>;
<a name="l00505"></a>00505    <span class="keywordflow">if</span> (GUI.Button (<span class="keyword">new</span> Rect (10 + (10+(Screen.width-40)/3)*2, 10, (Screen.width-40)/3, 50), 
<a name="l00506"></a>00506     temp+<span class="stringliteral">&quot;Next level&quot;</span>))
<a name="l00507"></a>00507       {
<a name="l00508"></a>00508     <a class="code" href="class_main_c_sharp.html#a0a84052811b18630763fd798707f9e00" title="Clears the level.">clearLevel</a>();
<a name="l00509"></a>00509     <a class="code" href="class_main_c_sharp.html#af77fa9c12a8e6a7af4d3cc60bd5dd456" title="Sets up the given level, i.e., calling loadLevel to read from .TMX file and invoking createObjects on...">setUpLevel</a>((<a class="code" href="class_main_c_sharp.html#ae6301bcd7df4ee345d1e856f27ebbc5d" title="The current level.">currLevel</a>+1)%<a class="code" href="class_main_c_sharp.html#a0c0ba607ea0288e769e1c0f93071d5a1" title="The number of levels.">numLevels</a>);
<a name="l00510"></a>00510     <a class="code" href="class_main_c_sharp.html#a5950269a5a22c0723fa8b86e897206fd" title="Starts the level.">startLevel</a>();
<a name="l00511"></a>00511    }
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513  }
<a name="l00514"></a>00514  
<a name="l00515"></a>00515  
<a name="l00516"></a>00516 }
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_main_c_sharp_8cs.html">MainCSharp.cs</a>      </li>
      <li class="footer">Generated on Thu Jun 21 2012 11:33:51 for UnityCAPIR by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
